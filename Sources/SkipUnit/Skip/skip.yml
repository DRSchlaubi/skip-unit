# skip.tools per-configuration file

#skip:
#  package: 'skip.unit'

# the blocks to add to the build.gradle.kts
build:
  contents:
    - block: 'plugins'
      contents:
        - 'kotlin("android") version "1.9.0"'
        - 'id("com.android.library") version "8.1.0"'

    - block: 'dependencies'
      export: false
      contents:
        # kotlin-bom specifies the default version of any subsequent Kotlin dependencies
        - 'api(platform("org.jetbrains.kotlin:kotlin-bom:1.9.0"))'
        - 'api("org.jetbrains.kotlin:kotlin-reflect")'
        - 'compileOnly("org.jetbrains.kotlin:kotlin-test")'
        - 'compileOnly("org.jetbrains.kotlin:kotlin-test-junit")'

    # test dependencies are exported to other packages, since they should not be included in api
    - block: 'dependencies'
      contents:
        - 'testImplementation("org.jetbrains.kotlin:kotlin-test")'
        - 'testImplementation("org.jetbrains.kotlin:kotlin-test-junit")'

        - 'testImplementation("org.jetbrains.kotlinx:kotlinx-coroutines-test:1.7.3")'
        - 'androidTestImplementation("org.jetbrains.kotlinx:kotlinx-coroutines-test:1.7.3")'

        - 'testImplementation("org.robolectric:robolectric:4.10.3")'
        - 'androidTestImplementation("androidx.test:runner:1.5.2")'

        - 'testImplementation("org.jetbrains.kotlin:kotlin-test-junit")'
        - 'androidTestImplementation("org.jetbrains.kotlin:kotlin-test-junit")'

        - 'testImplementation("androidx.test:core:1.5.0")'
        - 'androidTestImplementation("androidx.test:core:1.5.0")'

        - 'testImplementation("androidx.test.ext:junit:1.1.5")'
        - 'androidTestImplementation("androidx.test.ext:junit:1.1.5")'

    - block: 'android'
      contents:
        - 'namespace = group as String'
        - 'compileSdk = 34'
        - block: 'defaultConfig'
          contents:
            - 'minSdk = 29'
            - 'testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"'
        - block: 'compileOptions'
          contents:
            - 'sourceCompatibility = JavaVersion.VERSION_20'
            - 'targetCompatibility = JavaVersion.VERSION_20'

        - block: 'testOptions'
          contents:
            - block: 'unitTests'
              contents:
                - 'isIncludeAndroidResources = true'

    - block: 'tasks.withType<org.jetbrains.kotlin.gradle.tasks.KotlinCompile>()'
      contents:
        - block: 'kotlinOptions'
          contents:
            - 'suppressWarnings = true'

    - block: 'tasks.withType<Test>().configureEach'
      contents:
        - 'systemProperties.put("robolectric.logging", "stdout")'
        - 'systemProperties.put("robolectric.graphicsMode", "NATIVE")'
        - block: 'testLogging'
          contents:
            - 'this.showStandardStreams = true'

# the blocks to add to the settings.gradle.kts
settings:
  header: |
    // This is the top-level Gradle settings for the project.
    // The module dependencies it contains may be symbolic links to peer folders.
    //
    // This file is generated by the Skip transpiler plugin and is
    // derived from the aggregate Skip/skip.yml files from the SPM project.
    // Edits made directly to this file will be lost.
    //
    // Open with External Editor to build and run this project in an IDE.
    //
  contents:
    - block: 'pluginManagement'
      contents:
        - block: 'repositories'
          contents:
            - 'gradlePluginPortal()'
            - 'mavenCentral()'

    - block: 'dependencyResolutionManagement'
      contents:
        - 'repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)'
        - block: 'repositories'
          contents:
            - 'mavenCentral()'

    - block: 'pluginManagement'
      contents:
        - block: 'repositories'
          contents:
            - 'google()'

    - block: 'dependencyResolutionManagement'
      contents:
        - block: 'repositories'
          contents:
            - 'google()'
